{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block title %}friends{% endblock %}

{% block content %}
<!--全ユーザーを一覧表示する-->
<!--各ユーザーに「未読バッジ」付き-->
<!-- apps/templates/messengers/inbox.html -->
<h3 class="text-center">Friends</h3>
<div class="alert alert-warning text-center" role="alert">
  <strong>💡メッセージを送信する際のご注意</strong><br>
  暴力的な発言や、他者を不快にさせるような言葉の使用は控えてください。
</div>

<div class="d-flex justify-content-center">  <ul class="list-group list-group-flush" style="width: 80%;">  {% for u in users %}
            <li class="list-group-item d-flex align-items-center mb-3"> 
              {% if u.avatar %}
                    <img src="{{ u.avatar.url }}" alt="アバター画像"
                         class="rounded-circle me-2"
                         style="width: 64px; height: 64px; object-fit: cover;">
                {% else %}
                    <img src="{% static 'images/default_avatar.png' %}"
                         alt="デフォルトアバター"
                         class="rounded-circle me-2"
                         style="width: 64px; height: 64px; object-fit: cover;">
                {% endif %}

                <a href="{% url 'messengers:conversation' u.id %}">{{ u.username }}</a>
                {% if u.unread_count and u.unread_count > 0 %}
                    <span class="badge bg-danger rounded-pill ms-auto">{{ u.unread_count }}</span>
                {% endif %}
            </li>
        {% empty %}
            <li class="list-group-item text-muted">フォロー中のユーザーがいません</li>
        {% endfor %}
    </ul>
</div>
<!--※ views.py の inbox で users に未読件数をアノテーションして渡す-->
<style>
  .list-group-item {
  background-color: transparent !important;
  box-shadow: none !important;
  border: none !important;
}
  </style>
{% endblock %}
